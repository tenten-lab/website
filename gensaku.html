<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>åŸå…¸ç´¹ä»‹ï½œæ¬¡ã€ã©ã“ï¼Ÿ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    /* ===== å…¨åŸŸå­—å‹ & èƒŒæ™¯ ===== */
    body {
      margin: 0;
      font-family: "Noto Serif JP", "Yu Mincho", "Hiragino Mincho ProN", serif;
      min-height: 100vh;
      background: url('éƒ½å¸‚ä¼èª¬å·¡ã‚Š.png') no-repeat center center fixed; /* PC ç‰ˆèƒŒæ™¯ */
      background-size: cover;
      color: #fdf5f5;
      position: relative;
    }

    /* æš—éœ§ */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at 50% 0,
                  rgba(0,0,0,0.75),
                  rgba(0,0,0,0.95));
      z-index: -1;
    }

    /* å¹³æ¿èƒŒæ™¯ */
    @media (min-width: 769px) and (max-width: 1024px) {
      body {
        background-image: url('éƒ½å¸‚ä¼èª¬å·¡ã‚Š_pad.png'); /* ä½ å¯ä»¥æ›æˆè‡ªå·±çš„æª”å */
        background-position: center top;
        background-attachment: scroll;
      }
    }

    /* æ‰‹æ©ŸèƒŒæ™¯ */
    @media (max-width: 768px) {
      body {
        background-image: url('éƒ½å¸‚ä¼èª¬å·¡ã‚Š_sp.png');
        background-position: center top;
        background-attachment: scroll;
      }
    }

    /* ===== é ‚éƒ¨æ¨™é¡Œå€ ===== */
    header {
      position: fixed;
      top: 0;
      width: 100%;
      display: flex;
      justify-content: center;
      padding: 16px 10px 10px;
      z-index: 20;
      pointer-events: none;
    }

    .title-wrap {
      pointer-events: auto;
      background: radial-gradient(circle at 50% 0,
                  rgba(255,0,60,0.2),
                  rgba(0,0,0,0.92) 60%,
                  rgba(0,0,0,0.98) 100%);
      padding: 10px 48px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,120,150,0.8);
      box-shadow:
        0 0 24px rgba(255,0,0,0.8),
        0 0 55px rgba(0,0,0,0.98);
      text-align: center;
      min-width: 280px;
    }

    .title-main {
      margin: 0;
      font-size: 26px;
      letter-spacing: .2em;
      color: #fff5f8;
      text-shadow:
        0 0 8px rgba(255,100,120,0.9),
        0 0 18px rgba(0,0,0,1);
    }

    .title-sub-ja {
      display: block;
      margin-top: 4px;
      font-size: 14px;
      color: #ffd6de;
      letter-spacing: .18em;
    }

    .title-sub-zh {
      display: block;
      margin-top: 2px;
      font-size: 12px;
      color: #ffbfcf;
      opacity: 0.9;
      letter-spacing: .08em;
    }

    @media (max-width: 768px) {
      .title-wrap {
        padding: 8px 18px 10px;
        border-radius: 16px;
        max-width: 92%;
      }
      .title-main {
        font-size: 20px;
        letter-spacing: .16em;
      }
      .title-sub-ja {
        font-size: 12px;
      }
      .title-sub-zh {
        font-size: 11px;
      }
    }

    /* ===== ä¸»æ¡†ï¼šæœå°‹ + å…§å®¹ ===== */
    .page-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 170px 16px 32px;/* ===== è·é›¢ ===== */
      box-sizing: border-box;
    }

    .panel {
      background: radial-gradient(circle at 0 0,
                rgba(255,255,255,0.12),
                rgba(10,0,20,0.92) 55%,
                rgba(0,0,0,0.98) 100%);
      border-radius: 18px;
      padding: 18px 18px 22px;
      box-shadow:
        0 10px 30px rgba(0,0,0,0.8),
        0 0 18px rgba(255,120,160,0.35);
      border: 1px solid rgba(255,160,190,0.7);
      backdrop-filter: blur(5px);
    }

    /* ===== æœå°‹ & ç¯©é¸åˆ— ===== */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      margin-bottom: 12px;
    }

    .search-box {
      flex: 1 1 220px;
      max-width: 480px;
      position: relative;
    }
   
    /* ===== æœå°‹æ¡†ä¿®æ­£ ===== */

 .search-box input {
  width: 100%;
  box-sizing: border-box;      /* é˜²æ­¢è¶…å‡ºå®¹å™¨ */
  padding: 8px 12px 8px 34px; /* å·¦å´ç•™ icon ä½ç½® */
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.6);
  background: rgba(0,0,0,0.45);
  color: #fff;
  font-size: 14px;
  outline: none;
}


    .search-input-wrap {
  flex: 1 1 220px;
  max-width: 480px;
}

  .search-input-wrap input {
  width: 100%;
  box-sizing: border-box;   /* â˜… è¶…é‡è¦ */
  padding: 8px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.6);
}

    .search-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 14px;
      opacity: 0.8;
    }

    .region-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-end;
    }

    .region-btn {
      border: none;
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 12px;
      cursor: pointer;
      background: linear-gradient(90deg, #5f1830, #3a0d25);
      color: #ffe9f0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.6);
      transition: 0.2s;
      white-space: nowrap;
    }

    .region-btn:hover {
      background: linear-gradient(90deg, #cc365f, #7a213a);
      transform: translateY(-1px);
    }

    .region-btn.active {
      background: linear-gradient(90deg, #ff6a8f, #e73563);
      color: #2b000c;
      font-weight: 700;
    }

    @media (max-width: 768px) {
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      .region-filters {
        justify-content: center;
      }
      .page-inner {
    padding-top: 150px;
      }

    }

    /* ===== çµ±è¨ˆåˆ— ===== */
    .stats {
      font-size: 12px;
      color: #ffdde8;
      margin-bottom: 8px;
      text-align: right;
      opacity: 0.9;
    }

    /* ===== å¡ç‰‡åˆ—è¡¨ ===== */
    .cards {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
      margin-top: 8px;
    }

    @media (max-width: 1024px) {
      .cards {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .cards {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: radial-gradient(circle at 30% 0,
                 rgba(255,210,230,0.18),
                 rgba(20,0,25,0.96));
      border-radius: 14px;
      padding: 10px 10px 12px;
      display: flex;
      gap: 10px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.8);
      border: 1px solid rgba(255,160,190,0.8);
      transition: 0.22s;
      align-items: flex-start;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow:
        0 8px 20px rgba(0,0,0,0.95),
        0 0 16px rgba(255,150,190,0.6);
    }

    .card-thumb {
      width: 80px;
      height: 80px;
      border-radius: 10px;
      object-fit: cover;
      flex-shrink: 0;
      box-shadow: 0 3px 10px rgba(0,0,0,0.9);
      background: #000;
    }

    .card-body {
      flex: 1;
      min-width: 0;
    }

    .card-region {
      font-size: 11px;
      color: #ffb6c9;
      letter-spacing: .12em;
      margin-bottom: 2px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 700;
      margin: 0 0 2px;
      color: #ffeef5;
    }

    .card-title-zh {
      font-size: 11px;
      color: #ffd6e2;
      margin: 0 0 6px;
    }

    .card-pref {
      font-size: 11px;
      color: #ffd1da;
      margin-bottom: 4px;
    }

    .card-snippet {
      font-size: 11px;
      color: #ffe2ee;
      opacity: 0.9;
      line-height: 1.5;
    }

    /* ===== Modal è©³ç´° ===== */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      padding: 16px;
      box-sizing: border-box;
    }

    .modal-content {
      background: radial-gradient(circle at 0 0,
                  rgba(255,255,255,0.1),
                  #15000a 55%,
                  #040003 100%);
      width: 90%;
      max-width: 900px;
      border-radius: 18px;
      display: grid;
      grid-template-columns: 1.1fr 1.4fr;
      gap: 0;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(0,0,0,0.95);
      border: 1px solid rgba(255,160,190,0.8);
      max-height: 92vh;
    }

    .modal-image-wrap {
      position: relative;
      background: #000;
      overflow: hidden;
    }

    .modal-image-wrap img {
      width: 100%;
      height: auto;
      max-height: 100%;
      object-fit: contain; /* âœ… ä¸è£åˆ‡åœ–ç‰‡ */
    }

    .modal-region-tag {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.8);
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 11px;
      color: #ffdce4;
      border: 1px solid rgba(255,160,190,0.8);
    }

    .modal-body {
      padding: 14px 16px 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      overflow-y: auto;
    }

    .modal-title {
      font-size: 18px;
      margin: 0;
      color: #ffeef7;
    }

    .modal-title-zh {
      margin: 0;
      font-size: 13px;
      color: #ffd5e5;
    }

    .modal-pref {
      font-size: 12px;
      color: #ffccdd;
      margin-top: 4px;
      margin-bottom: 6px;
    }

    .label {
      font-size: 11px;
      color: #ffbcd4;
      margin-top: 6px;
      margin-bottom: 2px;
      letter-spacing: .15em;
    }

    .text-block {
      font-size: 13px;
      line-height: 1.7;
      background: radial-gradient(circle at 0 0,
                  rgba(255,255,255,0.05),
                  rgba(0,0,0,0.9));
      border-radius: 10px;
      padding: 8px 10px;
      border: 1px solid rgba(255,150,190,0.35);
      white-space: pre-line;   /* â˜… é€™è¡Œè¶…é‡è¦ï¼šä¿ç•™ \n â†’ é¡¯ç¤ºæˆæ›è¡Œ */
    }

    .text-block.zh {
      font-size: 13px;
      color: #ffecf3;
    }

    .modal-footer {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.8);
      white-space: nowrap;
    }

    .btn-close {
      background: linear-gradient(135deg, #ffb3c8, #ff829f);
      color: #3b0010;
    }

    .btn-link {
      background: linear-gradient(135deg, #2a1c4f, #412b80);
      color: #f5eefe;
      text-decoration: none;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 5px 14px rgba(0,0,0,0.9);
    }

    /* æ‰‹æ©Ÿç‰ˆ Modal å–®æ¬„ */
    @media (max-width: 768px) {
      .modal-content {
        grid-template-columns: 1fr;
        width: 96%;
        max-width: 560px;
      }
      .modal-body {
        padding: 12px;
      }
      .modal-image-wrap {
        max-height: 220px;
      }

    }

    /* å³ä¸‹è§’å›é¦–é  */
    .home-fab {
      position: fixed;
      right: 18px;
      bottom: 18px;
      background: radial-gradient(circle at 30% 30%, #ffe6ea, #ff7ca1);
      color: #600030;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 26px;
      cursor: pointer;
      box-shadow: 0 6px 14px rgba(0,0,0,0.7);
      z-index: 50;
      text-decoration: none;
      transition: 0.2s;
    }

    .home-fab:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 8px 18px rgba(0,0,0,0.85);
    }

    @media (max-width: 768px) {
      .home-fab {
        width: 50px;
        height: 50px;
        font-size: 22px;
        right: 14px;
        bottom: 14px;
      }
    }
  </style>
</head>
<body>

<header>
  <div class="title-wrap">
    <p class="title-main">åŸå…¸ç´¹ä»‹</p>
    <span class="title-sub-ja">ãƒ¼ éƒ½å¸‚ä¼èª¬ã®ã‚‚ã¨ã«ãªã£ãŸç‰©èªé›† ãƒ¼</span>
    <span class="title-sub-zh">éƒ½å¸‚å‚³èªªåŸæ•…äº‹ä¸€è¦½</span>
  </div>
</header>

<div class="page-inner">
  <div class="panel">
    <!-- æœå°‹ & ç¯©é¸åˆ— -->
    <div class="controls">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input id="searchInput" type="text" placeholder="éƒ½é“åºœçœŒåãƒ»åœ°åãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ / é—œéµå­—æœå°‹">
      </div>

      <div class="region-filters">
        <button class="region-btn active" data-region="all">ã™ã¹ã¦</button>
        <button class="region-btn" data-region="åŒ—æµ·é“">åŒ—æµ·é“</button>
        <button class="region-btn" data-region="æ±åŒ—">æ±åŒ—</button>
        <button class="region-btn" data-region="é–¢æ±">é–¢æ±</button>
        <button class="region-btn" data-region="ä¸­éƒ¨">ä¸­éƒ¨</button>
        <button class="region-btn" data-region="è¿‘ç•¿">è¿‘ç•¿</button>
        <button class="region-btn" data-region="ä¸­å›½">ä¸­å›½</button>
        <button class="region-btn" data-region="å››å›½">å››å›½</button>
        <button class="region-btn" data-region="ä¹å·">ä¹å·</button>
         <button class="region-btn" data-region="æ²–ç¸„">æ²–ç¸„</button>
      </div>
    </div>

    <div class="stats" id="stats"></div>

    <!-- å¡ç‰‡åˆ—è¡¨ -->
    <div class="cards" id="cards"></div>
  </div>
</div>

<!-- è©³ç´° Modal -->
<div class="modal" id="storyModal">
  <div class="modal-content">
    <div class="modal-image-wrap">
      <img id="modalImg" src="" alt="story">
      <div class="modal-region-tag" id="modalRegion"></div>
    </div>
    <div class="modal-body">
      <div>
        <h2 class="modal-title" id="modalTitleJa"></h2>
        <p class="modal-title-zh" id="modalTitleZh"></p>
        <p class="modal-pref" id="modalPref"></p>

        <div class="label">ã€ æ—¥æœ¬èª ã€‘</div>
        <div class="text-block" id="modalTextJa"></div>

        <div class="label">ã€ ä¸­æ–‡ ã€‘</div>
        <div class="text-block zh" id="modalTextZh"></div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-close" onclick="closeModal()">âœ• é–‰ã˜ã‚‹ / é—œé–‰</button>
        <!-- å¦‚æœä¹‹å¾Œæ¯ç¯‡æœ‰ã€ŒåŸå…¸é€£çµã€å¯ä»¥ç”¨é€™å€‹æŒ‰éˆ•å¸¶é€£çµ -->
        <a href="#" class="btn btn-link" id="modalLink" target="_blank" style="display:none;">
          ğŸ”— åŸå…¸ç´¹ä»‹ãƒšãƒ¼ã‚¸
        </a>
      </div>
    </div>
  </div>
</div>

<!-- å›é¦–é  (æ•…äº‹ä¸€è¦½ or ä¸»é¦–é ) -->
<a href="index.html" class="home-fab">ğŸ </a>

<script>
  // ======== é€™è£¡æ”¾ã€ŒåŸæ•…äº‹è³‡æ–™ã€ ========
  // ä¹‹å¾Œä½ åªè¦ä¸€ç›´å¾€è£¡é¢åŠ å°±å¥½
  // region: åŒ—æµ·é“ / æ±åŒ— / é–¢æ± / ä¸­éƒ¨ / è¿‘ç•¿ / ä¸­å›½ãƒ»å››å›½ / ä¹å·ãƒ»æ²–ç¸„
  const stories = [
   {
  id: "hokkaido-abashiri",
  region: "åŒ—æµ·é“",
  prefecture: "åŒ—æµ·é“",
  titleJa: "ç¶²èµ°ç›£ç„",
  titleZh: "ç¶²èµ°ç›£ç„",
  thumb: "hokaido.png",
  image: "hokaido.png",
  textJa: `æ—¥æœ¬åŒ—æµ·é“ç¶²èµ°å¸‚ã«ã‚ã‚‹ç¶²èµ°ç›£ç„ã¯ã€æ˜æ²»æ™‚ä»£ã«å»ºã¦ã‚‰ã‚ŒãŸæœ¨é€ ã®åˆ‘å‹™æ‰€ã§ã‚ã‚‹ã€‚å½“æ™‚ã€æ”¿åºœã¯ãƒ­ã‚·ã‚¢ã®å—ä¸‹æ”¿ç­–ã«å‚™ãˆã‚‹ãŸã‚ã€æ€¥é€Ÿã«åŒ—æµ·é“ã®é–‹æ‹“ã‚’é€²ã‚ã¦ã„ãŸã€‚
  ãã®ãŸã‚ã€å¤šãã®å›šäººãŸã¡ãŒéé…·ãªåŠ´åƒã«å¾“äº‹ã•ã›ã‚‰ã‚Œã€åŒ—æµ·é“ã®é–‹æ‹“ã«å‹•å“¡ã•ã‚ŒãŸã€‚ä½œæ¥­ã¯éå¸¸ã«å³ã—ãã€200äººä»¥ä¸Šã®å›šäººãŒçŠ ç‰²ã¨ãªã£ãŸã¨ã„ã‚ã‚Œã¦ã„ã‚‹ã€‚
  ç¾åœ¨ã§ã‚‚ã€ç¶²èµ°å¸‚ã§ã¯å›šäººã®éœŠã‚’ç›®æ’ƒã—ãŸã¨ã„ã†å™‚ãŒçµ¶ãˆãšã€å›šäººå¢“åœ°ã§ã¯é›†å›£ã®è¶³éŸ³ãŒèã“ãˆã‚‹ã€‚ç¶²èµ°ç›£ç„åšç‰©é¤¨ã§ã¯ã€äººå½¢ã®å›šäººã¨ç›®ãŒåˆã£ãŸã‚ˆã†ã«æ„Ÿã˜ã‚‹ãªã©ã€ä¸æ€è­°ãªç¾è±¡ãŒèªã‚Šç¶™ãŒã‚Œã¦ã„ã‚‹ã€‚
  ã“ã‚Œã‚‰ã®è©±ã¯ã€ä»ŠãªãŠç¶²èµ°ç›£ç„ã«å›šã‚ã‚ŒãŸé­‚ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã„ã†éƒ½å¸‚ä¼èª¬ã‚’ç”Ÿã¿å‡ºã—ã¦ã„ã‚‹ã€‚`,

  textZh: `ä½æ–¼æ—¥æœ¬åŒ—æµ·é“ç¶²èµ°å¸‚çš„ç¶²èµ°ç›£ç„ï¼Œæ˜¯åœ¨æ˜æ²»æ™‚ä»£æ‰€å»ºé€ çš„æœ¨é€ ç›£ç„ã€‚ç•¶æ™‚ï¼Œæ”¿åºœç‚ºäº†é˜²å‚™ä¿„ç¾…æ–¯çš„å—ä¸‹æ”¿ç­–ï¼Œè€ŒåŠ é€Ÿæ¨å‹•åŒ—æµ·é“çš„é–‹ç™¼ï¼Œå› æ­¤å¤§é‡å›šçŠ¯è¢«è¿«å¾äº‹è‰±è‹¦çš„å‹å‹•ï¼Œä¸¦æŠ•å…¥åŒ—æµ·é“çš„é–‹æ‹“ã€‚
  ç”±æ–¼ä½œæ¥­ç’°å¢ƒæ¥µç‚ºåš´è‹›ï¼Œç›¸å‚³æœ‰è¶…é 200 åå›šçŠ¯å› æ­¤å–ªå‘½ã€‚ ç›´åˆ°ç¾åœ¨ï¼Œç¶²èµ°å¸‚ä»ä¸æ™‚æµå‚³æœ‰äººç›®æ“Šå›šçŠ¯å¹½éˆçš„å‚³èï¼Œåƒæ˜¯åœ¨å›šçŠ¯å¢“åœ°ä¸­ï¼Œæœ‰äººè½è¦‹æˆç¾¤çš„è…³æ­¥è²ï¼›
  åœ¨ç¶²èµ°ç›£ç„åšç‰©é¤¨è£¡ï¼Œä¹Ÿæœ‰äººè¡¨ç¤ºæ›¾æ„Ÿè¦ºèˆ‡åšç‰©é¤¨æ‰€å±•ç¤ºå›šçŠ¯çš„äººå¶å››ç›®ç›¸å°ç­‰ä¸å¯æ€è­°çš„ç¾è±¡ã€‚ é€™äº›æ•…äº‹ä¹Ÿè¡ç”Ÿå‡ºäº†ï¼Œè‡³ä»Šæ˜¯å¦æœ‰äº¡é­‚è¢«å›°åœ¨ç¶²èµ°ç›£ç„ä¹‹ä¸­æœªèƒ½è§£è„«çš„éƒ½å¸‚å‚³èªªã€‚ `,
  originUrl: ""
},

    {
      id: "tokyo-sendagaya",
      region: "é–¢æ±",
      prefecture: "æ±äº¬éƒ½",
      titleJa: "åƒé§„ãƒ¶è°·ãƒˆãƒ³ãƒãƒ«",
      titleZh: "åƒé§„è°·éš§é“",
      thumb: "tokyo.png",
      image: "tokyo.png",
      textJa: "",
      textZh: "",
      originUrl: ""
    },
    {
      id: "miyazaki-aoshima",
      region: "ä¹å·",
      prefecture: "å®®å´çœŒ",
      titleJa: "é’å³¶ãƒ»ã‚°ãƒªãƒ¼ãƒ³ãƒ‘ãƒ¼ã‚¯ã®å™‚",
      titleZh: "é’å³¶ç¶ åœ’çš„å‚³è",
      thumb: "miyazaki.png",
      image: "miyazaki.png",
      textJa: "",
      textZh: "",
      originUrl: ""
    }
  ];

  const cardsContainer = document.getElementById("cards");
  const searchInput = document.getElementById("searchInput");
  const statsEl = document.getElementById("stats");
  const regionButtons = document.querySelectorAll(".region-btn");

  let currentRegion = "all";
  let currentKeyword = "";

  function renderCards() {
    const keyword = currentKeyword.trim().toLowerCase();

    const filtered = stories.filter(st => {
      // åœ°å€ç¯©é¸
      if (currentRegion !== "all" && st.region !== currentRegion) return false;

      // é—œéµå­—æœå°‹ï¼šç¸£åã€æ¨™é¡Œã€å…§æ–‡
      if (keyword) {
        const haystack = [
          st.prefecture,
          st.titleJa,
          st.titleZh,
          st.textJa,
          st.textZh
        ].join(" ").toLowerCase();

        if (!haystack.includes(keyword)) return false;
      }
      return true;
    });

    statsEl.textContent = `è©²å½“ï¼š${filtered.length} ä»¶ / å…¨ ${stories.length} ä»¶`;

    cardsContainer.innerHTML = "";
    if (filtered.length === 0) {
      cardsContainer.innerHTML = "<p style='font-size:13px; color:#ffdce7; text-align:center; padding:12px 0;'>è©²å½“ã™ã‚‹åŸå…¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„åœ°åŸŸã‚’å¤‰ãˆã¦ã¿ã¦ãã ã•ã„ã€‚</p>";
      return;
    }

    filtered.forEach(st => {
      const card = document.createElement("div");
      card.className = "card";
      card.onclick = () => openModal(st);

      const img = document.createElement("img");
      img.className = "card-thumb";
      img.src = st.thumb || st.image;
      img.alt = st.titleJa;

      const body = document.createElement("div");
      body.className = "card-body";

      const region = document.createElement("div");
      region.className = "card-region";
      region.textContent = `${st.region}ãƒ»${st.prefecture}`;

      const title = document.createElement("p");
      title.className = "card-title";
      title.textContent = st.titleJa;

      const titleZh = document.createElement("p");
      titleZh.className = "card-title-zh";
      titleZh.textContent = `ï¼ˆ${st.titleZh}ï¼‰`;

      const pref = document.createElement("p");
      pref.className = "card-pref";
      pref.textContent = st.prefecture;

      const snippet = document.createElement("p");
      snippet.className = "card-snippet";
      const shortText = (st.textJa || "").slice(0, 60);
      snippet.textContent = shortText + (st.textJa.length > 60 ? "â€¦" : "");

      body.appendChild(region);
      body.appendChild(title);
      body.appendChild(titleZh);
      body.appendChild(snippet);

      card.appendChild(img);
      card.appendChild(body);
      cardsContainer.appendChild(card);
    });
  }

  // æœå°‹è¼¸å…¥
  searchInput.addEventListener("input", (e) => {
    currentKeyword = e.target.value;
    renderCards();
  });

  // åœ°å€æŒ‰éˆ•é»æ“Š
  regionButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      regionButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      currentRegion = btn.dataset.region;
      renderCards();
    });
  });

  // Modal æ§åˆ¶
  const modal = document.getElementById("storyModal");
  const modalImg = document.getElementById("modalImg");
  const modalRegion = document.getElementById("modalRegion");
  const modalTitleJa = document.getElementById("modalTitleJa");
  const modalTitleZh = document.getElementById("modalTitleZh");
  const modalPref = document.getElementById("modalPref");
  const modalTextJa = document.getElementById("modalTextJa");
  const modalTextZh = document.getElementById("modalTextZh");
  const modalLink = document.getElementById("modalLink");

  function openModal(story) {
    modalImg.src = story.image || story.thumb;
    modalRegion.textContent = `${story.region}ãƒ»${story.prefecture}`;
    modalTitleJa.textContent = story.titleJa;
    modalTitleZh.textContent = `ï¼ˆ${story.titleZh}ï¼‰`;
    modalPref.textContent = story.prefecture;
    modalTextJa.textContent = story.textJa;
    modalTextZh.textContent = story.textZh;

    if (story.originUrl) {
      modalLink.href = story.originUrl;
      modalLink.style.display = "inline-flex";
    } else {
      modalLink.style.display = "none";
    }

    modal.style.display = "flex";
    document.body.style.overflow = "hidden";
  }

  function closeModal() {
    modal.style.display = "none";
    document.body.style.overflow = "";
  }

  window.closeModal = closeModal;

  // é»é»‘å¹•é—œé–‰
  modal.addEventListener("click", (e) => {
    if (e.target === modal) {
      closeModal();
    }
  });

  // ESC é—œé–‰
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && modal.style.display === "flex") {
      closeModal();
    }
  });

  // åˆå§‹æ¸²æŸ“
  renderCards();
</script>

</body>
</html>
